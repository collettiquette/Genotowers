var EasyStar=EasyStar||{};"function"==typeof define&&define.amd&&define("easystar",[],function(){return EasyStar}),"undefined"!=typeof module&&module.exports&&(module.exports=EasyStar),EasyStar.Node=function(t,i,e,n,s){this.parent=t,this.x=i,this.y=e,this.costSoFar=n,this.simpleDistanceToTarget=s,this.bestGuessDistance=function(){return this.costSoFar+this.simpleDistanceToTarget}},EasyStar.Node.OPEN_LIST=0,EasyStar.Node.CLOSED_LIST=1,EasyStar.PriorityQueue=function(t,i){this.length=0;var e=[],n=!1;if(i==EasyStar.PriorityQueue.MAX_HEAP)n=!0;else{if(i!=EasyStar.PriorityQueue.MIN_HEAP)throw i+" not supported.";n=!1}this.insert=function(i){if(!i.hasOwnProperty(t))throw"Cannot insert "+i+" because it does not have a property by the name of "+t+".";e.push(i),this.length++,s(this.length-1)},this.getHighestPriorityElement=function(){return e[0]},this.shiftHighestPriorityElement=function(){if(0===this.length)throw"There are no more elements in your priority queue.";if(1===this.length){var t=e[0];return e=[],this.length=0,t}var i=e[0],n=e.pop();return this.length--,e[0]=n,a(0),i};var s=function(t){if(0!==t){var i=l(t);o(t,i)&&(r(t,i),s(i))}},a=function(t){var i=u(t),e=h(t);if(o(i,t))r(t,i),a(i);else if(o(e,t))r(t,e),a(e);else{if(0==t)return;a(0)}},r=function(t,i){var n=e[t];e[t]=e[i],e[i]=n},o=function(i,s){if(void 0===e[s]||void 0===e[i])return!1;var a,r;return"function"==typeof e[i][t]?(a=e[i][t](),r=e[s][t]()):(a=e[i][t],r=e[s][t]),n?a>r?!0:!1:r>a?!0:!1},l=function(t){return Math.floor(t/2)-1},u=function(t){return 2*t+1},h=function(t){return 2*t+2}},EasyStar.PriorityQueue.MAX_HEAP=0,EasyStar.PriorityQueue.MIN_HEAP=1,EasyStar.instance=function(){this.isDoneCalculating=!0,this.pointsToAvoid={},this.startX,this.callback,this.startY,this.endX,this.endY,this.nodeHash={},this.openList},EasyStar.js=function(){var t,i,e,n=10,s=14,a={},r={},o=[],l=Number.MAX_VALUE,u=!1;this.setAcceptableTiles=function(t){t instanceof Array?e=t:!isNaN(parseFloat(t))&&isFinite(t)&&(e=[t])},this.enableDiagonals=function(){u=!0},this.disableDiagonals=function(){u=!1},this.setGrid=function(i){t=i;for(var e=0;e<t.length;e++)for(var n=0;n<t[0].length;n++)r[t[e][n]]||(r[t[e][n]]=1)},this.setTileCost=function(t,i){r[t]=i},this.setIterationsPerCalculation=function(t){l=t},this.avoidAdditionalPoint=function(t,i){a[t+"_"+i]=1},this.stopAvoidingAdditionalPoint=function(t,i){delete a[t+"_"+i]},this.stopAvoidingAllAdditionalPoints=function(){a={}},this.findPath=function(i,s,a,r,l){if(void 0===e)throw new Error("You can't set a path without first calling setAcceptableTiles() on EasyStar.");if(void 0===t)throw new Error("You can't set a path without first calling setGrid() on EasyStar.");if(0>i||0>s||0>a||0>a||i>t[0].length-1||s>t.length-1||a>t[0].length-1||r>t.length-1)throw new Error("Your start or end point is outside the scope of your grid.");if(i===a&&s===r)return void l([]);for(var u=t[r][a],h=!1,c=0;c<e.length;c++)if(u===e[c]){h=!0;break}if(h===!1)return void l(null);var y=new EasyStar.instance;y.openList=new EasyStar.PriorityQueue("bestGuessDistance",EasyStar.PriorityQueue.MIN_HEAP),y.isDoneCalculating=!1,y.nodeHash={},y.startX=i,y.startY=s,y.endX=a,y.endY=r,y.callback=l,y.openList.insert(f(y,y.startX,y.startY,null,n)),o.push(y)},this.calculate=function(){if(0!==o.length&&void 0!==t&&void 0!==e)for(i=0;l>i;i++){if(0===o.length)return;if(0!==o[0].openList.length){var a=o[0].openList.shiftHighestPriorityElement();if(a.list=EasyStar.Node.CLOSED_LIST,a.y>0&&(h(o[0],a,0,-1,n*r[t[a.y-1][a.x]]),o[0].isDoneCalculating===!0))o.shift();else if(a.x<t[0].length-1&&(h(o[0],a,1,0,n*r[t[a.y][a.x+1]]),o[0].isDoneCalculating===!0))o.shift();else if(a.y<t.length-1&&(h(o[0],a,0,1,n*r[t[a.y+1][a.x]]),o[0].isDoneCalculating===!0))o.shift();else if(a.x>0&&(h(o[0],a,-1,0,n*r[t[a.y][a.x-1]]),o[0].isDoneCalculating===!0))o.shift();else if(u){if(a.x>0&&a.y>0&&(h(o[0],a,-1,-1,s*r[t[a.y-1][a.x-1]]),o[0].isDoneCalculating===!0)){o.shift();continue}if(a.x<t[0].length-1&&a.y<t.length-1&&(h(o[0],a,1,1,s*r[t[a.y+1][a.x+1]]),o[0].isDoneCalculating===!0)){o.shift();continue}if(a.x<t[0].length-1&&a.y>0&&(h(o[0],a,1,-1,s*r[t[a.y-1][a.x+1]]),o[0].isDoneCalculating===!0)){o.shift();continue}if(a.x>0&&a.y<t.length-1&&(h(o[0],a,-1,1,s*r[t[a.y+1][a.x-1]]),o[0].isDoneCalculating===!0)){o.shift();continue}}}else o[0].callback(null),o.shift()}};var h=function(i,n,s,r,o){var l=n.x+s,u=n.y+r;if(void 0===a[l+"_"+u]){if(i.endX===l&&i.endY===u){i.isDoneCalculating=!0;var h=[],c=0;h[c]={x:l,y:u},c++,h[c]={x:n.x,y:n.y},c++;for(var y=n.parent;null!=y;)h[c]={x:y.x,y:y.y},c++,y=y.parent;h.reverse(),i.callback(h)}for(var d=0;d<e.length;d++)if(t[u][l]===e[d]){var g=f(i,l,u,n,o);void 0===g.list?(g.list=EasyStar.Node.OPEN_LIST,i.openList.insert(g)):g.list===EasyStar.Node.OPEN_LIST&&n.costSoFar+o<g.costSoFar&&(g.costSoFar=n.costSoFar+o,g.parent=n);break}}},f=function(t,i,e,n,s){if(void 0!==t.nodeHash[i+"_"+e])return t.nodeHash[i+"_"+e];var a=c(i,e,t.endX,t.endY);if(null!==n)var r=n.costSoFar+s;else r=a;var o=new EasyStar.Node(n,i,e,r,a);return t.nodeHash[i+"_"+e]=o,o},c=function(t,i,e,s){return Math.sqrt(Math.abs(e-t)*Math.abs(e-t)+Math.abs(s-i)*Math.abs(s-i))*n}};